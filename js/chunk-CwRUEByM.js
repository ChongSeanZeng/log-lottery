import{u as e,g as a}from"./chunk-Dd0MDqUR.js";import{a as s}from"./chunk-Dv7RK_ed.js";import{d as t,u as l,s as n,r,l as i,h as o,w as u,a as c,o as m,b as d,q as v,t as p,j as g,F as f,B as h,m as b}from"./chunk-FIPsYJBc.js";const k={class:"toast toast-top toast-end"},y={key:0,class:"alert alert-error"},w={key:1,class:"alert alert-success"},I={key:2,class:"alert alert-error"},x={class:""},C={for:"explore"},S=["accept"],j={class:"btn btn-primary btn-sm"},q={class:"p-0"},F={class:"flex items-center gap-8"},T={class:"avatar h-14"},$={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},_={class:"w-64"},B={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},D=["onClick"],L=t({__name:"ImageConfig",setup(t){const{t:L}=l(),N=e().globalConfig,{getImageList:U}=n(N),z=r("image/*"),A=r(0),E=i.createInstance({name:"imgStore"});async function G(e){if(!/image*/.test(e.target.files[0].type))return void(A.value=3);const{dataUrl:a,fileName:t}=await s(e.target.files[0]);E.setItem(`${(new Date).getTime().toString()}+${t}`,a).then(()=>{A.value=1,async function(){(await E.keys()).length>0&&E.iterate((e,a)=>{N.addImage({id:a,name:a,url:"Storage"})})}()}).catch(()=>{A.value=2})}return o(()=>{}),u(()=>A.value,e=>{0!==e&&setTimeout(()=>{A.value=0},2e3)}),(e,s)=>(m(),c(f,null,[d("div",k,[2===A.value?(m(),c("div",y,[d("span",null,p(g(L)("error.uploadFail")),1)])):v("",!0),1===A.value?(m(),c("div",w,[d("span",null,p(g(L)("error.uploadSuccess")),1)])):v("",!0),3===A.value?(m(),c("div",I,[d("span",null,p(g(L)("error.notImage")),1)])):v("",!0)]),d("div",null,[d("div",x,[d("label",C,[d("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:z.value,onChange:G},null,40,S),d("span",j,p(g(L)("button.upload")),1)])]),d("ul",q,[(m(!0),c(f,null,h(g(U),e=>(m(),c("li",{key:e.id,class:"mb-3"},[d("div",F,[d("div",T,[d("div",$,[b(a,{"img-item":e},null,8,["img-item"])])]),d("div",_,[d("div",B,p(e.name),1)]),d("div",null,[d("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&E.removeItem(e.id).then(()=>{N.removeImage(e.id)}),N.removeImage(e.id)}(e)},p(g(L)("button.delete")),9,D)])])]))),128))])])],64))}});export{L as default};
